<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Parsing EML &bull; EML</title><!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous"><script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous"><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">EML</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ropensci/EML">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Parsing EML</h1>
                        <h4 class="author">Carl Boettiger</h4>
            
            <h4 class="date">2016-12-20</h4>
          </div>

    
    
<div class="contents">
<p>The function <code><a href="../reference/eml_get.html">eml_get()</a></code> extracts a list of <em>all occurances</em> the desired metadata elements from a given <code>eml</code> object or part thereof.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">"EML"</span>)
f &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">"xsd/test/eml-i18n.xml"</span>, <span class="dt">package =</span> <span class="st">"EML"</span>)
eml &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_eml.html">read_eml</a></span>(f)</code></pre></div>
<p>Here we request all <code>coverage</code> elements occurring in the anywhere in the <code>eml</code> document:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">coverage &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eml_get.html">eml_get</a></span>(eml, <span class="st">"coverage"</span>)
coverage</code></pre></div>
<pre><code>## [[1]]
## &lt;coverage scope="document"&gt;
##   &lt;geographicCoverage scope="document"&gt;
##     &lt;geographicDescription&gt;The Geographic region of the kelp bed data
##                  extends along the California coast, down through the coast of Baja,
##                  Mexico: Central California (Halfmoon Bay to Purisima Point),
##                  Southern California (Point Arguello to the United States/Mexico
##                  border including the Channel Islands) and Baja California (points
##                  south of the United States/Mexico border including several offshore
##                  islands).&lt;/geographicDescription&gt;
##     &lt;boundingCoordinates&gt;
##       &lt;westBoundingCoordinate&gt;-122.44&lt;/westBoundingCoordinate&gt;
##       &lt;eastBoundingCoordinate&gt;-117.15&lt;/eastBoundingCoordinate&gt;
##       &lt;northBoundingCoordinate&gt;37.38&lt;/northBoundingCoordinate&gt;
##       &lt;southBoundingCoordinate&gt;30.00&lt;/southBoundingCoordinate&gt;
##     &lt;/boundingCoordinates&gt;
##   &lt;/geographicCoverage&gt;
##   &lt;temporalCoverage scope="document"&gt;
##     &lt;rangeOfDates&gt;
##       &lt;beginDate&gt;
##         &lt;calendarDate&gt;1957-08-13&lt;/calendarDate&gt;
##       &lt;/beginDate&gt;
##       &lt;endDate&gt;
##         &lt;calendarDate&gt;2006-02-18&lt;/calendarDate&gt;
##       &lt;/endDate&gt;
##     &lt;/rangeOfDates&gt;
##   &lt;/temporalCoverage&gt;
##   &lt;taxonomicCoverage scope="document"&gt;
##     &lt;taxonomicClassification&gt;
##       &lt;taxonRankName&gt;KINGDOM&lt;/taxonRankName&gt;
##       &lt;taxonRankValue&gt;Plantae&lt;/taxonRankValue&gt;
##       &lt;taxonomicClassification&gt;
##         &lt;taxonRankName&gt;PHYLUM&lt;/taxonRankName&gt;
##         &lt;taxonRankValue&gt;Phaeophyta&lt;/taxonRankValue&gt;
##         &lt;taxonomicClassification&gt;
##           &lt;taxonRankName&gt;CLASS&lt;/taxonRankName&gt;
##           &lt;taxonRankValue&gt;Phaeophyceae&lt;/taxonRankValue&gt;
##           &lt;taxonomicClassification&gt;
##             &lt;taxonRankName&gt;ORDER&lt;/taxonRankName&gt;
##             &lt;taxonRankValue&gt;Laminariales&lt;/taxonRankValue&gt;
##             &lt;taxonomicClassification&gt;
##               &lt;taxonRankName&gt;FAMILY&lt;/taxonRankName&gt;
##               &lt;taxonRankValue&gt;Lessoniaceae&lt;/taxonRankValue&gt;
##               &lt;taxonomicClassification&gt;
##                 &lt;taxonRankName&gt;GENUS&lt;/taxonRankName&gt;
##                 &lt;taxonRankValue&gt;Macrocystis&lt;/taxonRankValue&gt;
##                 &lt;taxonomicClassification&gt;
##                   &lt;taxonRankName&gt;genusSpecies&lt;/taxonRankName&gt;
##                   &lt;taxonRankValue&gt;Macrocystis pyrifera&lt;/taxonRankValue&gt;
##                   &lt;taxonomicClassification&gt;
##                     &lt;taxonRankName&gt;commonName&lt;/taxonRankName&gt;
##                     &lt;taxonRankValue&gt;MAPY&lt;/taxonRankValue&gt;
##                   &lt;/taxonomicClassification&gt;
##                 &lt;/taxonomicClassification&gt;
##               &lt;/taxonomicClassification&gt;
##             &lt;/taxonomicClassification&gt;
##           &lt;/taxonomicClassification&gt;
##         &lt;/taxonomicClassification&gt;
##       &lt;/taxonomicClassification&gt;
##     &lt;/taxonomicClassification&gt;
##   &lt;/taxonomicCoverage&gt;
## &lt;/coverage&gt;</code></pre>
<p>The result is a list containing 1 <code>coverage</code> element. We can further subset this element directly using <code><a href="../reference/eml_get.html">eml_get()</a></code> on it, for instance, to extract just the <code>temporalCoverage</code> element:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/eml_get.html">eml_get</a></span>(coverage, <span class="st">"temporalCoverage"</span>)</code></pre></div>
<pre><code>## An object of class "ListOftemporalCoverage"
## [[1]]
## &lt;temporalCoverage scope="document"&gt;
##   &lt;rangeOfDates&gt;
##     &lt;beginDate&gt;
##       &lt;calendarDate&gt;1957-08-13&lt;/calendarDate&gt;
##     &lt;/beginDate&gt;
##     &lt;endDate&gt;
##       &lt;calendarDate&gt;2006-02-18&lt;/calendarDate&gt;
##     &lt;/endDate&gt;
##   &lt;/rangeOfDates&gt;
## &lt;/temporalCoverage&gt;</code></pre>
<p>Any EML element can be extracted in this way. Let&rsquo;s try an example metadata file for a <code>dataset</code> that documents 11 seperate <code>dataTables</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eml_HARV &lt;-<span class="st"> </span><span class="kw"><a href="../reference/read_eml.html">read_eml</a></span>(<span class="st">"http://harvardforest.fas.harvard.edu/data/eml/hf001.xml"</span>)</code></pre></div>
<p>How many <code>dataTable</code> entities are there in this dataset?</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">dt &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eml_get.html">eml_get</a></span>(eml_HARV, <span class="st">"dataTable"</span>)
<span class="kw">length</span>(dt)</code></pre></div>
<pre><code>## [1] 11</code></pre>
<p>We can iterate over our list of <code>dataTable</code> elements to extract relevant metadata, such as the <code>entityName</code> or the download <code>url</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">entities &lt;-<span class="st"> </span><span class="kw">sapply</span>(dt, eml_get, <span class="st">"entityName"</span>)
urls &lt;-<span class="st"> </span><span class="kw">sapply</span>(dt, eml_get, <span class="st">"url"</span>)</code></pre></div>
<p>Note that the latter example is the same as providing the more verbose arbument that specificies exactly where the <code>url</code> of interest is located:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">urls &lt;-<span class="st"> </span><span class="kw">sapply</span>(dt, function(x) x@physical[[<span class="dv">1</span>]]@distribution[[<span class="dv">1</span>]]@online@url)</code></pre></div>
<p>this verbose syntax can be useful if there are multiple <code>url</code> elements in each <code>dataTable</code> metadata, and we are trying to get only certain ones and not others. Specifying the exact path in this way can also improve the speed of the command. For these reasons, programmatic use should consider this format, while the much simpler <code>eml_get</code> example shown above is practical for most interactive applications.</p>
<p>All though the default return type for <code>eml_get</code> is just the S4 object (whose <code>print</code> method displays the corresponding XML structure used to represent that metadata), for a few commonly accessed complex elements, <code>eml_get</code> returns a more convenient <code>data.frame</code>. For instance, the <code>attributeList</code> describing the metadata for every column in an EML document is returned as a pair of <code>data.frame</code>s, one for all the attributes, and an second optional <code>data.frame</code> defnining the levels for the factors, if any are used. Let&rsquo;s take a look:</p>
<p>Here we get the <code>attributeList</code> for each <code>dataTable</code> in the dataset. We check the length to confirm we get one <code>attributeList</code> for each <code>dataTable</code></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">attrs &lt;-<span class="st"> </span><span class="kw"><a href="../reference/eml_get.html">eml_get</a></span>(dt, <span class="st">"attributeList"</span>) 
<span class="kw">length</span>(attrs)</code></pre></div>
<pre><code>## [1] 11</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">attrs[[<span class="dv">1</span>]]</code></pre></div>
<pre><code>## $attributes
##   attributeName     domain formatString precision minimum maximum
## 1          date       &lt;NA&gt;         &lt;NA&gt;        NA    &lt;NA&gt;    &lt;NA&gt;
## 2         notes textDomain         &lt;NA&gt;        NA    &lt;NA&gt;    &lt;NA&gt;
##   definition pattern source attributeLabel storageType missingValueCode
## 1       &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;             &lt;NA&gt;
## 2      notes    &lt;NA&gt;   &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;             &lt;NA&gt;
##   missingValueCodeExplanation measurementScale attributeDefinition
## 1                        &lt;NA&gt;         dateTime                date
## 2                        &lt;NA&gt;          nominal               notes
## 
## $factors
## NULL</code></pre>
<p>(Note, we could have passed this argument the original <code>eml_HARV</code> instead of <code>dt</code> here, since we know all <code>attributeList</code> elements are inside <code>dataTable</code> elements, but this is a bit more explicit and a bit faster.)</p>
<p>This returned <code>data.frame</code> object containing the attribute metadata for the first table (hence the <code>[[1]]</code>, though <code>attrs</code> contains this metadata for all 11 tables now.) This is the same result we would have gotten using the more explicit call to the helper function <code><a href="../reference/get_attributes.html">get_attributes()</a></code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_attributes.html">get_attributes</a></span>(eml_HARV@dataset@dataTable[[<span class="dv">1</span>]]@attributeList)</code></pre></div>
<pre><code>## $attributes
##   attributeName     domain formatString precision minimum maximum
## 1          date       &lt;NA&gt;         &lt;NA&gt;        NA    &lt;NA&gt;    &lt;NA&gt;
## 2         notes textDomain         &lt;NA&gt;        NA    &lt;NA&gt;    &lt;NA&gt;
##   definition pattern source attributeLabel storageType missingValueCode
## 1       &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;             &lt;NA&gt;
## 2      notes    &lt;NA&gt;   &lt;NA&gt;           &lt;NA&gt;        &lt;NA&gt;             &lt;NA&gt;
##   missingValueCodeExplanation measurementScale attributeDefinition
## 1                        &lt;NA&gt;         dateTime                date
## 2                        &lt;NA&gt;          nominal               notes
## 
## $factors
## NULL</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Carl Boettiger, Matthew B. Jones.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer></div>

  </body></html>
